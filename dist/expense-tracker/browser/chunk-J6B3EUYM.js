import{Kb as m,Lb as g,M as u,Q as h,a as o,b as p,m as s,q as c,x as i}from"./chunk-2AP6R54K.js";var b={production:!1,API_URL:"http://127.0.0.1:5000"};var r=b.API_URL,d=class l{constructor(t){this.http=t}LS_KEY="transactions";register(t){return this.http.post(`${r}/auth/register`,t)}login(t){return this.http.post(`${r}/auth/login`,t)}getTransactions(){return this.http.get(`${r}/transactions`).pipe(c(t=>t.transactions||[]),i(()=>s(this.getAllLocal())))}addTransaction(t){return this.http.post(`${r}/transactions`,t).pipe(i(()=>s(this.createLocal(t))))}updateTransaction(t,e){return this.http.put(`${r}/transactions/${t}`,e).pipe(i(()=>s(this.updateLocal(t,e))))}deleteTransaction(t){return this.http.delete(`${r}/transactions/${t}`).pipe(i(()=>(this.deleteLocal(t),s({deleted:!0}))))}getMonthlySummary(){return this.http.get(`${r}/summary`)}getBudget(){return this.http.get(`${r}/budget`)}upsertBudget(t,e=90){return this.http.put(`${r}/budget`,{limit:t,threshold:e})}exportTransactionsCsv(t){let e=new m;return t&&(e=e.set("type",t)),this.http.get(`${r}/transactions/export/csv`,{responseType:"blob",params:e})}getAllLocal(){try{return JSON.parse(localStorage.getItem(this.LS_KEY)||"[]")}catch{return[]}}setAllLocal(t){localStorage.setItem(this.LS_KEY,JSON.stringify(t))}createLocal(t){let e=this.getAllLocal(),n=p(o({},t),{id:crypto.randomUUID?crypto.randomUUID():String(Date.now())});return e.push(n),this.setAllLocal(e),n}updateLocal(t,e){let n=this.getAllLocal(),a=n.findIndex(x=>x.id===t);return a>=0?(n[a]=o(o({},n[a]),e),this.setAllLocal(n),n[a]):null}deleteLocal(t){this.setAllLocal(this.getAllLocal().filter(e=>e.id!==t))}static \u0275fac=function(e){return new(e||l)(h(g))};static \u0275prov=u({token:l,factory:l.\u0275fac,providedIn:"root"})};export{d as a};

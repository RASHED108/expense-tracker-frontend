"use strict";(self.webpackChunkexpense_tracker=self.webpackChunkexpense_tracker||[]).push([[457],{7457:(j,p,d)=>{d.r(p),d.d(p,{TransactionsComponent:()=>C});var _=d(2200),s=d(4341),r=d(2615),t=d(3664),g=d(3366);function u(a,c){1&a&&(t.j41(0,"div"),t.EFF(1,"Loading\u2026"),t.k0s())}function m(a,c){if(1&a&&(t.j41(0,"div",9),t.EFF(1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.JRh(n.error)}}function b(a,c){if(1&a){const n=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.nI1(3,"currency"),t.k0s(),t.j41(4,"td"),t.EFF(5),t.k0s(),t.j41(6,"td"),t.EFF(7),t.nI1(8,"date"),t.k0s(),t.j41(9,"td"),t.EFF(10),t.k0s(),t.j41(11,"td",10)(12,"button",4),t.bIt("click",function(){const e=r.eBV(n).$implicit,o=t.XpG();return r.Njj(o.openEdit(e))}),t.EFF(13,"Edit"),t.k0s(),t.j41(14,"button",4),t.bIt("click",function(){const e=r.eBV(n).$implicit,o=t.XpG();return r.Njj(o.delete(e.id))}),t.EFF(15,"Delete"),t.k0s()()()}if(2&a){const n=c.$implicit;t.R7$(2),t.JRh(t.bMT(3,4,n.amount)),t.R7$(3),t.JRh(n.category),t.R7$(2),t.JRh(t.i5U(8,6,n.date,"MMM d, y")),t.R7$(3),t.JRh(n.note)}}function F(a,c){1&a&&(t.j41(0,"tr")(1,"td",11),t.EFF(2,"No income entries."),t.k0s()())}function f(a,c){if(1&a){const n=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.nI1(3,"currency"),t.k0s(),t.j41(4,"td"),t.EFF(5),t.k0s(),t.j41(6,"td"),t.EFF(7),t.nI1(8,"date"),t.k0s(),t.j41(9,"td"),t.EFF(10),t.k0s(),t.j41(11,"td",10)(12,"button",4),t.bIt("click",function(){const e=r.eBV(n).$implicit,o=t.XpG();return r.Njj(o.openEdit(e))}),t.EFF(13,"Edit"),t.k0s(),t.j41(14,"button",4),t.bIt("click",function(){const e=r.eBV(n).$implicit,o=t.XpG();return r.Njj(o.delete(e.id))}),t.EFF(15,"Delete"),t.k0s()()()}if(2&a){const n=c.$implicit;t.R7$(2),t.JRh(t.bMT(3,4,n.amount)),t.R7$(3),t.JRh(n.category),t.R7$(2),t.JRh(t.i5U(8,6,n.date,"MMM d, y")),t.R7$(3),t.JRh(n.note)}}function k(a,c){1&a&&(t.j41(0,"tr")(1,"td",11),t.EFF(2,"No expense entries."),t.k0s()())}function h(a,c){if(1&a){const n=t.RV6();t.j41(0,"div",12),t.bIt("click",function(){r.eBV(n);const e=t.XpG();return r.Njj(e.closeEdit())}),t.j41(1,"div",13),t.bIt("click",function(e){return r.eBV(n),r.Njj(e.stopPropagation())}),t.j41(2,"h3"),t.EFF(3,"Edit Transaction"),t.k0s(),t.j41(4,"form",14,0),t.bIt("ngSubmit",function(){r.eBV(n);const e=t.XpG();return r.Njj(e.saveEdit())}),t.j41(6,"div",15)(7,"div")(8,"label"),t.EFF(9,"Type"),t.k0s(),t.j41(10,"select",16),t.mxI("ngModelChange",function(e){r.eBV(n);const o=t.XpG();return t.DH7(o.editing.type,e)||(o.editing.type=e),r.Njj(e)}),t.j41(11,"option",17),t.EFF(12,"Income"),t.k0s(),t.j41(13,"option",18),t.EFF(14,"Expense"),t.k0s()()(),t.j41(15,"div")(16,"label"),t.EFF(17,"Amount"),t.k0s(),t.j41(18,"input",19),t.mxI("ngModelChange",function(e){r.eBV(n);const o=t.XpG();return t.DH7(o.editing.amount,e)||(o.editing.amount=e),r.Njj(e)}),t.k0s()(),t.j41(19,"div")(20,"label"),t.EFF(21,"Category"),t.k0s(),t.j41(22,"select",20),t.mxI("ngModelChange",function(e){r.eBV(n);const o=t.XpG();return t.DH7(o.editing.category,e)||(o.editing.category=e),r.Njj(e)}),t.j41(23,"option",21),t.EFF(24,"Food"),t.k0s(),t.j41(25,"option",22),t.EFF(26,"Rent"),t.k0s(),t.j41(27,"option",23),t.EFF(28,"Transport"),t.k0s(),t.j41(29,"option",24),t.EFF(30,"Entertainment"),t.k0s(),t.j41(31,"option",25),t.EFF(32,"Other"),t.k0s()()(),t.j41(33,"div")(34,"label"),t.EFF(35,"Date"),t.k0s(),t.j41(36,"input",26),t.mxI("ngModelChange",function(e){r.eBV(n);const o=t.XpG();return t.DH7(o.editing.date,e)||(o.editing.date=e),r.Njj(e)}),t.k0s()(),t.j41(37,"div",27)(38,"label"),t.EFF(39,"Note"),t.k0s(),t.j41(40,"input",28),t.mxI("ngModelChange",function(e){r.eBV(n);const o=t.XpG();return t.DH7(o.editing.note,e)||(o.editing.note=e),r.Njj(e)}),t.k0s()()(),t.j41(41,"div",29)(42,"button",30),t.bIt("click",function(){r.eBV(n);const e=t.XpG();return r.Njj(e.closeEdit())}),t.EFF(43,"Cancel"),t.k0s(),t.j41(44,"button",31),t.EFF(45,"Save"),t.k0s()()()()()}if(2&a){const n=t.sdS(5),i=t.XpG();t.R7$(10),t.R50("ngModel",i.editing.type),t.R7$(8),t.R50("ngModel",i.editing.amount),t.R7$(4),t.R50("ngModel",i.editing.category),t.R7$(14),t.R50("ngModel",i.editing.date),t.R7$(4),t.R50("ngModel",i.editing.note),t.R7$(4),t.Y8G("disabled",!n.form.valid)}}let C=(()=>{class a{api;transactions=[];loading=!0;error="";editOpen=!1;editing=null;editingId="";constructor(n){this.api=n}ngOnInit(){this.fetch()}fetch(){this.loading=!0,this.api.getTransactions().subscribe({next:n=>{this.transactions=n||[],this.loading=!1},error:()=>{this.loading=!1,this.error="Failed to load transactions."}})}get incomes(){return this.transactions.filter(n=>"income"===n.type)}get expenses(){return this.transactions.filter(n=>"expense"===n.type)}openEdit(n){this.editingId=n.id||"",this.editing={...n},this.editOpen=!0}closeEdit(){this.editOpen=!1,this.editing=null,this.editingId=""}saveEdit(){if(!this.editing||!this.editingId)return;const n=this.editing;if(!n.type||!n.category||!n.date||!n.note||!isFinite(Number(n.amount))||Number(n.amount)<=0)return void alert("Please fill all fields with valid values.");const i={type:n.type,category:n.category,amount:Number(n.amount),date:n.date,note:n.note.trim()};this.api.updateTransaction(this.editingId,i).subscribe({next:e=>{const o=this.transactions.findIndex(l=>l.id===this.editingId);o>=0&&(this.transactions[o]=e),this.closeEdit()},error:()=>alert("Failed to update transaction.")})}delete(n){n&&confirm("Delete this transaction?")&&this.api.deleteTransaction(n).subscribe({next:()=>this.transactions=this.transactions.filter(i=>i.id!==n),error:()=>alert("Failed to delete.")})}exportCsv(n){this.api.exportTransactionsCsv("all"===n?void 0:n).subscribe({next:e=>{const o=URL.createObjectURL(e),l=document.createElement("a"),E=`transactions_${n||"all"}.csv`;l.href=o,l.download=E,document.body.appendChild(l),l.click(),l.remove(),URL.revokeObjectURL(o)},error:()=>alert("CSV export failed.")})}static \u0275fac=function(i){return new(i||a)(t.rXU(g.G))};static \u0275cmp=t.VBU({type:a,selectors:[["app-transactions"]],decls:46,vars:7,consts:[["editForm","ngForm"],[4,"ngIf"],["class","error",4,"ngIf"],[1,"btn-row"],[3,"click"],[1,"section-title"],[1,"table"],[4,"ngFor","ngForOf"],["class","modal-backdrop",3,"click",4,"ngIf"],[1,"error"],[1,"table-actions"],["colspan","5"],[1,"modal-backdrop",3,"click"],[1,"modal",3,"click"],[3,"ngSubmit"],[1,"grid"],["name","type","required","",3,"ngModelChange","ngModel"],["value","income"],["value","expense"],["type","number","min","0.01","step","0.01","name","amount","required","",3,"ngModelChange","ngModel"],["name","category","required","",3,"ngModelChange","ngModel"],["value","Food"],["value","Rent"],["value","Transport"],["value","Entertainment"],["value","Other"],["type","date","name","date","required","",3,"ngModelChange","ngModel"],[1,"span-2"],["type","text","maxlength","80","name","note","required","",3,"ngModelChange","ngModel"],[1,"actions"],["type","button",3,"click"],["type","submit",3,"disabled"]],template:function(i,e){1&i&&(t.j41(0,"h2"),t.EFF(1,"Transactions"),t.k0s(),t.DNE(2,u,2,0,"div",1)(3,m,2,1,"div",2),t.j41(4,"div",3)(5,"button",4),t.bIt("click",function(){return e.exportCsv("all")}),t.EFF(6,"Export CSV (All)"),t.k0s(),t.j41(7,"button",4),t.bIt("click",function(){return e.exportCsv("income")}),t.EFF(8,"Export CSV (Income)"),t.k0s(),t.j41(9,"button",4),t.bIt("click",function(){return e.exportCsv("expense")}),t.EFF(10,"Export CSV (Expense)"),t.k0s()(),t.j41(11,"div",5),t.EFF(12,"Income"),t.k0s(),t.j41(13,"table",6)(14,"thead")(15,"tr")(16,"th"),t.EFF(17,"Amount"),t.k0s(),t.j41(18,"th"),t.EFF(19,"Category"),t.k0s(),t.j41(20,"th"),t.EFF(21,"Date"),t.k0s(),t.j41(22,"th"),t.EFF(23,"Note"),t.k0s(),t.nrm(24,"th"),t.k0s()(),t.j41(25,"tbody"),t.DNE(26,b,16,9,"tr",7)(27,F,3,0,"tr",1),t.k0s()(),t.j41(28,"div",5),t.EFF(29,"Expenses"),t.k0s(),t.j41(30,"table",6)(31,"thead")(32,"tr")(33,"th"),t.EFF(34,"Amount"),t.k0s(),t.j41(35,"th"),t.EFF(36,"Category"),t.k0s(),t.j41(37,"th"),t.EFF(38,"Date"),t.k0s(),t.j41(39,"th"),t.EFF(40,"Note"),t.k0s(),t.nrm(41,"th"),t.k0s()(),t.j41(42,"tbody"),t.DNE(43,f,16,9,"tr",7)(44,k,3,0,"tr",1),t.k0s()(),t.DNE(45,h,46,6,"div",8)),2&i&&(t.R7$(2),t.Y8G("ngIf",e.loading),t.R7$(),t.Y8G("ngIf",e.error),t.R7$(23),t.Y8G("ngForOf",e.incomes),t.R7$(),t.Y8G("ngIf",0===e.incomes.length),t.R7$(16),t.Y8G("ngForOf",e.expenses),t.R7$(),t.Y8G("ngIf",0===e.expenses.length),t.R7$(),t.Y8G("ngIf",e.editOpen))},dependencies:[_.MD,_.Sq,_.bT,s.YN,s.qT,s.xH,s.y7,s.me,s.Q0,s.wz,s.BC,s.cb,s.YS,s.tU,s.VZ,s.vS,s.cV,_.oe,_.vh],styles:[".filters[_ngcontent-%COMP%], .summary[_ngcontent-%COMP%]{margin-bottom:1rem;display:flex;gap:1rem;align-items:center;flex-wrap:wrap}.summary[_ngcontent-%COMP%]{background:#f8f9fa;padding:.75rem;border:1px solid #ddd;border-radius:6px;font-size:.95rem}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-bottom:1.5rem}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5rem;border:1px solid #ccc;text-align:left}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f2f2f2}.section-title[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:700;margin:1rem 0 .5rem}button[_ngcontent-%COMP%]{padding:.25rem .6rem;background:#dc143c;color:#fff;border:none;border-radius:4px;cursor:pointer;transition:background .2s}button[_ngcontent-%COMP%]:hover{background:#8b0000}button.active[_ngcontent-%COMP%]{background:#333;font-weight:700}.export-btn[_ngcontent-%COMP%]{background:#007bff}.export-btn[_ngcontent-%COMP%]:hover{background:#0056b3}.delete-income[_ngcontent-%COMP%]{background:#17a2b8}.delete-income[_ngcontent-%COMP%]:hover{background:#117a8b}.delete-expense[_ngcontent-%COMP%]{background:#dc143c}.delete-expense[_ngcontent-%COMP%]:hover{background:#8b0000}.pagination[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center;flex-wrap:wrap}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:#eee;color:#333;border:1px solid #ccc}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:#dc143c;color:#fff}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(.active){background:#ddd}select[_ngcontent-%COMP%]{padding:.25rem;border-radius:4px;border:1px solid #ccc}"]})}return a})()}}]);